drop database DA1
go 
create database DUAN1
---- tao bang---
-- khach hang 
if OBJECT_ID('VaiTro') is not null
drop table VaiTro
go 
create table VaiTro
(
	IDVaiTro VARCHAR(10) NOT NULL,
	Vaitro NVARCHAR(50) NULL,
	CONSTRAINT PK_VaiTro PRIMARY KEY(IDVaiTro)
)
if OBJECT_ID('NguoiDung') is not null
drop table NguoiDung
go 
create table NguoiDung
(
	IDNguoiDung VARCHAR(10) NOT NULL,
	IDVaiTro VARCHAR(10) NULL,
	TEN NVARCHAR(10) NULL,
	MatKhau VARCHAR(10) Not NULL,
	DIACHI NVARCHAR (50) NULL,
	EMAIL VARCHAR (50) NOT NULL,
	DTHOAI VARCHAR (15) NULL,
	Trangthai NVARCHAR (50) NULL,
	CONSTRAINT PK_NguoiDung PRIMARY KEY(IDNguoiDung),
	CONSTRAINT FK_NguoiDung_VaiTro FOREIGN KEY (IDVaiTro) REFERENCES VaiTro
)
-- san pham 
IF OBJECT_ID('SANPHAM') IS NOT NULL
DROP TABLE SANPHAM
GO 
CREATE TABLE SANPHAM
( 
	MASP VARCHAR(10) NOT NULL Primary key,
	TENSP NVARCHAR(30) NULL,
	SOLUONG INT NULL,
	GIABAN MONEY NULL,
	TRANGTHAI NVARCHAR (50) NULL,
)
IF OBJECT_ID('NhaCungCap') IS NOT NULL
DROP TABLE NhaCungCap
GO 
CREATE TABLE NhaCungCap
( 
	IDNCC VARCHAR(10) NOT NULL,
	TENNCC NVARCHAR(30) NULL,
	EMAIL NVARCHAR (50),
	SDT NVARCHAR(15) NULL,
	LOAIDICHVU NVARCHAR(30) NULL,
	DIACHI NVARCHAR(100) NULL,
	DIEUKHOANHOPTAC NVARCHAR (50) NULL,
	CONSTRAINT PK_NhaCungCap PRIMARY KEY (IDNCC)
)
IF OBJECT_ID('MAGIAMGIA') IS NOT NULL
DROP TABLE MAGIAMGIA
GO 
CREATE TABLE MAGIAMGIA
( 
	IDMAGIAMGIA VARCHAR(10) NOT NULL,
	TENMA NVARCHAR(50) NULL,
	PHAMTRAMGIAM INT NULL,
	NGAYBATDAU DATETIME NULL,
	NGAYKETTHUC DATETIME NULL,
	CONSTRAINT PK_MAGIAMGIA PRIMARY KEY (IDMAGIAMGIA)
	
)
IF OBJECT_ID('MAUSAC') IS NOT NULL
DROP TABLE MAUSAC
GO 
CREATE TABLE MAUSAC
( 
	IDMAU VARCHAR(10) NOT NULL,
	MAU NVARCHAR(50) NOT NULL,
	CONSTRAINT PK_MAUSAC PRIMARY KEY (MAU )
)
IF OBJECT_ID('CHATLIEU') IS NOT NULL
DROP TABLE CHATLIEU
GO 
CREATE TABLE CHATLIEU
( 
	IDCHATLIEU VARCHAR(10) NOT NULL,
	CHATLIEU NVARCHAR(50) NOT NULL,
	CONSTRAINT PK_CHATLIEU PRIMARY KEY (CHATLIEU)
)
IF OBJECT_ID('KICHTHUOC') IS NOT NULL
DROP TABLE KICHTHUOC
GO 
CREATE TABLE KICHTHUOC
(	
	ID_KICHTHUOC VARCHAR(10) NOT NULL,
	KICHTHUOC NVARCHAR(50) NOT NULL,
	CONSTRAINT PK_KICHTHUOC PRIMARY KEY (KICHTHUOC)
)
IF OBJECT_ID('DEGIAY') IS NOT NULL
DROP TABLE DEGIAY
GO 
CREATE TABLE DEGIAY
(	
	ID_DEGIAY VARCHAR(10) NOT NULL,
	DEGIAY NVARCHAR(50) NOT NULL,
	CONSTRAINT PK_DEGIAY PRIMARY KEY (DEGIAY)
)
IF OBJECT_ID('CTSANPHAM') IS NOT NULL
DROP TABLE CTSANPHAM
GO 
CREATE TABLE CTSANPHAM
( 
	IDCTSP VARCHAR(10) NOT NULL,
	IDNCC VARCHAR(10) NULL,
	MASP VARCHAR(10) NULL,
	IDMAU NVARCHAR(50) NULL,
	IDCHATLIEU NVARCHAR(50) NULL,
	IDKICHTHUOC NVARCHAR(50) NULL,
	IDDEGIAY NVARCHAR(50) NULL,
	TENGIAY NVARCHAR(50) NULL,
	GIABAN MONEY NULL,
	CONSTRAINT PK_CTSANPHAM PRIMARY KEY (IDCTSP),
	CONSTRAINT FK_CTSANPHAM_NhaCungCap FOREIGN KEY (IDNCC) REFERENCES NhaCungCap,
	CONSTRAINT FK_CTSANPHAM_SANPHAM FOREIGN KEY (MASP) REFERENCES SANPHAM,
	CONSTRAINT FK_CTSANPHAM_MAUSAC FOREIGN KEY (IDMAU) REFERENCES MAUSAC,
	CONSTRAINT FK_CTSANPHAM_CHATLIEU FOREIGN KEY (IDCHATLIEU) REFERENCES CHATLIEU,
	CONSTRAINT FK_CTSANPHAM_KICHTHUOC FOREIGN KEY (IDKICHTHUOC) REFERENCES KICHTHUOC,
	CONSTRAINT FK_CTSANPHAM_DEGIAY FOREIGN KEY (IDDEGIAY) REFERENCES DEGIAY
)

IF OBJECT_ID('LOAIKHACHHANG') IS NOT NULL
DROP TABLE LOAIKHACHHANG
GO
CREATE TABLE LOAIKHACHHANG
(
	IDLOAIND VARCHAR(10) NOT NULL,
	TEN NVARCHAR(30) NULL,
	DIEM VARCHAR(10) NULL,
	MOTA NVARCHAR(50) NULL,
	CONSTRAINT PK_LOAIKHACHHANG PRIMARY KEY (IDLOAIND),
)
IF OBJECT_ID('KHACHHANG') IS NOT NULL
DROP TABLE KHACHHANG
GO
CREATE TABLE KHACHHANG
(
	IDKH VARCHAR(10) NOT NULL,
	IDLOAIND VARCHAR(10) NULL,
	TEN NVARCHAR(50) NULL,
	SDT NVARCHAR(15) NULL,
	DIACHI NVARCHAR (50) NULL,
	EMAIL NVARCHAR (50) NULL,
	DIEM VARCHAR(10) NULL,
	CONSTRAINT PK_KHACHHANG PRIMARY KEY (IDKH),
	CONSTRAINT FK_KHACHHANG_LOAIKHACHHANG FOREIGN KEY (IDLOAIND) REFERENCES LOAIKHACHHANG
)
-- hoa don 
IF OBJECT_ID('HOADON') IS NOT NULL
DROP TABLE HOADON
GO
CREATE TABLE HOADON
(
	MAHD VARCHAR(10) NOT NULL,
	IDKH VARCHAR(10) null,
	IDNguoiDung varchar(10) null,
	IDMAGIAMGIA VARCHAR(10) NULL,
	NGAYBAN DATETIME NULL,
	TENSP NVARCHAR(50) NULL,
	SOLUONG INT NULL,
	TONGTIEN MONEY NULL,
	TRANGTHAI NVARCHAR(50) NULL,
	CONSTRAINT PK_HOADON PRIMARY KEY (MAHD),
	CONSTRAINT FK_HOADON_KHACHHANG FOREIGN KEY (IDKH) REFERENCES KHACHHANG,
	CONSTRAINT FK_HOADON_NGUOIDUNG FOREIGN KEY (IDNguoiDung) REFERENCES NguoiDung,
	CONSTRAINT FK_HOADON_MAGIAMGIA FOREIGN KEY (IDMAGIAMGIA) REFERENCES MAGIAMGIA
)

-- hoa don CT
IF OBJECT_ID('HOADONCT') IS NOT NULL 
DROP TABLE HOADONCT
GO
CREATE TABLE HOADONCT
(
	MAHD VARCHAR(10) NOT NULL,
	IDCTSP VARCHAR(10) NOT NULL,
	SLBAN INT NULL,
	GIA MONEY NULL,
	NGAYBAN DATETIME NULL,
	CONSTRAINT FK_HOADONCT_HOADON FOREIGN KEY (MAHD) REFERENCES HOADON,
	CONSTRAINT FK_HOADONCT_CTSANPHAM FOREIGN KEY (IDCTSP) REFERENCES CTSANPHAM,
	CONSTRAINT PK_HOADONCT PRIMARY KEY (MAHD,IDCTSP)
)
--------CHÈN DỮ LIỆU
---BẢNG KHÁCH HÀNG
DELETE FROM VaiTro
INSERT INTO VaiTro VALUES
	('VT01',N'ADMIN'),
	('VT02',N'NHANVIEN')

DELETE FROM NguoiDung
INSERT INTO NguoiDung VALUES
	('ND01','VT01',N'phạm tiến','AB1111',N'HA NOI','VIETPQPH46072@FPT.EDU.VN','0358406612','DANG LAM'),
	('ND02','VT02',N'phạm ABC','AB2222',N'VIET NAM','VIETPQPH@FPT.EDU.VN','0358406612','NGHI VIEC')
	SELECT * from NguoiDung

----BẢNG SẢN PHẨM
DELETE FROM SANPHAM
INSERT INTO SANPHAM VALUES
	('SP01',N'SNEAKER JORDAN 1',15,1690000,N''),
	('SP02',N'SNEAKER JORDAN 4 ',10,2400000,N'')
	SELECT * from SANPHAM
DELETE FROM NhaCungCap
INSERT INTO NhaCungCap VALUES
	('NCC01',N'HOANG HA',N'HOANGHAGIAY@FPT.EDU.VN',N'02533332',N'SI GIAY JORDAN','QUOC OAI',N'UY TIN'),
	('NCC02',N'PHUONG DONG',N'PHUONGDONG@FPT.EDU.VN',N'036287197',N'SI GIAY JORDAN','HA DONG',N'DOC QUYEN')
DELETE FROM MAGIAMGIA
INSERT INTO MAGIAMGIA VALUES
	('MGG01',N'VALENTINE',20,01-10-2024,10-10-2024),
	('MGG02',N'BLACKFRIDAY',30,10-4-2024,20-4-2024)
	DELETE FROM MAUSAC
INSERT INTO MAUSAC VALUES
	('M01',N'XANH'),
	('M02',N'TRANG')
		DELETE FROM CHATLIEU
INSERT INTO CHATLIEU VALUES
	('CL01',N'VAI CAO CAP'),
	('CL02',N'VAI TRUNG QUOC')
	DELETE FROM KICHTHUOC
INSERT INTO KICHTHUOC VALUES
	('KT01',N'41'),
	('KT02',N'39')
	DELETE FROM DEGIAY
INSERT INTO DEGIAY VALUES
	('DG01',N'CHIRSTY'),
	('DG02',N'POLYURETHANE')
	DELETE FROM CTSANPHAM
INSERT INTO CTSANPHAM VALUES
	('CTSP01','NCC01','SP02',N'XANH',N'VAI CAO CAP',N'41',N'POLYURETHANE',N'sneaker jordan',1690000),
	('CTSP02','NCC02','SP01',N'TRANG',N'VAI TRUNG QUOC',N'39',N'CHIRSTY',N'sneaker jordan',1790000)
	SELECT * from CTSANPHAM
	DELETE FROM LOAIKHACHHANG
INSERT INTO LOAIKHACHHANG VALUES
	('LKH01',N'DUNG PHAM','8',N' NO KHACH 20K'),
	('LKH02',N'MESSI','20',N' KHACH VIP')
	DELETE FROM KHACHHANG
INSERT INTO KHACHHANG VALUES
	('KH01','LKH01',N'DUNG PHAM',N'098273554',N'ME TRI',N'ABCD@GMAIL.COM','8'),
	('KH02','LKH01',N'RONALDO',N'0392642',N'CAU GIAY',N'OOWSS@GMAIL.COM','20')
----BẢNG HÓA ĐƠN
DELETE FROM HOADON
INSERT INTO HOADON VALUES
	('HD01','KH01','ND01','MGG01','7-23-2023',N'jodan',2,3200,N'DA TT'),
	('HD02','KH02','ND02','MGG02','8-5-2023',N'giay xanh',2,4600,N'CHUA TT')
----BẢNG HÓA ĐƠN CHI TIẾT
DELETE FROM HOADONCT
INSERT INTO HOADONCT VALUES
	('HD01','CTSP01',1,3200,'7-23-2023'),
	('HD02','CTSP02',2,9600,'8-5-2023')


----TRUY VẤN
SELECT*FROM VaiTro
SELECT*FROM NguoiDung
SELECT*FROM SANPHAM
SELECT*FROM NhaCungCap

SELECT*FROM MAUSAC
SELECT*FROM CHATLIEU
SELECT*FROM KICHTHUOC
SELECT*FROM CTSANPHAM
SELECT*FROM LOAIKHACHHANG
SELECT*FROM KHACHHANG
SELECT*FROM HOADON
SELECT*FROM HOADONCT
SELECT*FROM DEGIAY

ALTER TABLE CTSANPHAM
ADD GIABAN money